/*! lxapp 2016-03-15 */
!function(a){function b(a,b){for(var c,d,e=b.split("."),f=e.length,g=a,h=0;f>h;++h){if(c=e[h],!(c in g))return{obj:null,prop:null};d=g,g=g[e[h]]}return{obj:d,prop:g}}function c(c,d,e){function f(){var f,g=b(a,c),h=!1;return null==g.prop&&(g=b(a.$nativeSimulator,c),g&&(h=!0)),g.prop&&g.obj?(console.log("//调用Native接口 "+c+"参数:\n"+JSON.stringify(arguments)),"function"==typeof g.prop?(g.prop.before=d,g.prop.after=e,g.prop.length!=arguments.length&&console.log("//警告:实参与形参数量不一致:"+arguments.length+"/"+g.prop.length),f=g.prop.apply(h?this:g.obj,arguments)):f=g.prop,console.log("//完毕,返回:"+JSON.stringify(f))):a.console&&console.log&&console.log("//未实现Native接口 "+c+"参数:\n"+JSON.stringify(arguments)),f}return c=c.replace(/\(.*$/,""),f.before=d,f.after=e,f}function d(a,b,c){var d,e,f=a.attr("data-param1"),g=a.attr("data-param2");if(d=null===f&&null===g?[]:null!==f&&null===g?[f]:[f,g],"news.showFullImage"==b){var h=a[0].getAttribute("src");if(!h)return}if(("photo.showFullImage"==b||"news.showFullImage"==b)&&(2==d.length&&(d.length=1),e=a[0].getBoundingClientRect(),d.push(e.left),d.push(e.top),d.push(e.width),d.push(e.height),g&&d.push(g)),"related.viewRelatedArticel"==b||"related.viewRelatedVideo"==b||"related.viewHotArticel"==b||"dingyue.rssListItem"==b){var i=devicePixelRatio||webkitDevicePixelRatio||mozDevicePixelRatio||1,j=c.clientX,k=c.clientY,l={},m=a.index();"related.viewRelatedArticel"==b&&(m=a.data("index")),1!=i&&(j*=i,k*=i),l.screenPos=j+","+k,l.clickNews={},"related.viewRelatedArticel"==b?l.clickNews=window.detListData.related[m]:"related.viewHotArticel"==b?l.clickNews=window.detListData.hotNewsList[m]:"related.viewRelatedVideo"==b?l.clickNews=window.detListData.related_video[m]:l.clickNews=window.detListData.media.news[m],d=[JSON.stringify(l)]}return d}a.FastClick&&FastClick.attach(document.body);var e=a.$nativeApi={},f=$(".wrapper");a.$nativeSimulator={$_news:{},$_video:{},$_timeline:{},$_baike:{},$_related:{},$_dingyue:{}},a.$_news||(a.$nativeSimulator.$_news.OnClickShare=function(){function b(a){a?(e.show(),f.show()):(e.hide(),f.hide())}function c(){b(!1)}function d(a){var c=f.find("p");"weixin"==a?a="点击右上角，选择“发送给好友”":"circle"==a&&(a="点击右上角，选择“分享到朋友圈”"),a?c.text(a):c.text(c.attr("data-default")),b(!0)}var e=$("#mask"),f=$(".open-in-browser-tip");return e.tap(c),f.find(".close").tap(c),a.showTip=d,d}(),a.$nativeSimulator.$_news.onArticleRendered=function(){return!0},a.$nativeSimulator.$_news.onArticleImgLoaded=function(a){return!0}),$nativeApi.__=c;var g=e.news={},h=e.related={},i=e.music={},j=e.photo={},k=e.video={},l=e.baike={},m=e.timeline={},n=e.dingyue={};g.showComments=c("$_news.OnClickCmtMore()"),g.recommend=c("$_news.OnClickRecommend()"),g.comment=c("$_news.comment()"),g.showFullText=c("$_news.OnClickText()"),g.media=c("$_news.OnClickMedia()"),g.showFullImage=c("$_news.OnClickImg(imgUrl,allImgs)"),g.digg=c("$_news.OnClickDigg()",function(){var a=this.find("span");return this.hasClass("tapped")?!0:(this.find("img").attr("src",{stc:"images/icon-thumbup-active.png"}.stc),this.addClass("selected"),this.closest(".vote-simple").find(".thumb").addClass("tapped"),a.text(parseInt(a.text(),10)+1),!0)}),g.seeMore=c("$_news.OnClickCmtMore()"),g.commUser=c("$_news.OnClickCommUser()"),g.showAlbum=c("$_news.OnClickAlbum()"),g.share=c("$_news.OnClickShare()"),g.searchTag=c("$_news.OnSearchTag()"),g.articleRendered=c("$_news.onArticleRendered()"),g.articleImgLoaded=c("$_news.onArticleImgLoaded(String imgUrl)"),g.likeThisComment=c("$_news.OnClickCmtLike(String cid)",function(){var a=this.hasClass("thumb-beat");return a||(this.hide(),this.next().show()),!a},function(){this.next().addClass("thumb-beat");var a=this.parent().find(".liked"),b=parseInt(a.text(),10);a.text(b+1)}),m.showFullText=c("$_timeline.showFullText()"),h.viewRelatedArticel=c("$_related.OnClickRelated(String url)"),h.viewRelatedVideo=c("$_related.OnClickVideoList(String json)"),h.viewEditorArticle=c("$_related.OnClickEditorArticle(String url)"),h.OnHitLog=c("$_related.OnHitLog(String json)"),h.viewHotArticel=c("$_related.OnClickHotArticle(String url)"),h.clkTopic=c("$_related.OnClickTopic(String json)"),i.play=c("$_music.play"),i.stop=c("$_music.stop"),f.delegate(".music .play-button","click",function(){var a=$(this),b=(a.find("img"),f.find(".music .play-button"));a.hasClass("stop")?(i.play(a.attr("data-musicid")),b.not(a).removeClass("playing").addClass("stop"),a.removeClass("stop").addClass("playing")):a.hasClass("playing")&&(i.stop(),a.removeClass("playing").addClass("stop"))}),j.showFullImage=c("$_photo.OnClickPhoto"),j.search=c("$_photo.OnClickSearchPhoto");new Date;k.play=c("$_video.OnClickVideo"),l.showFullText=c("$_baike.OnClickBaike"),n.addRss=c("$_dingyue.OnClickRss"),n.rssListItem=c("$_dingyue.OnClickRssList");var o=!1,p=null,q=$(".wrapper");q.delegate(".native-call","click",function(a){if(a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),0!=o)return clearTimeout(p),p=setTimeout(function(){o=!1},1e3),!1;o=!0,p=setTimeout(function(){o=!1},1e3);var c=$(this);if(!c.attr("disabled")){var f,g=c.attr("data-native"),h=d(c,g,a),i=b(e,g),j=!0;return i.prop&&i.prop.before&&(j=i.prop.before.call(c)),j&&i.prop&&(f=i.prop.apply(c,h),f!==!1&&i.prop.after&&i.prop.after.call(c)),!1}}).delegate(".pseudo-a","click",function(a){if(a.target===this){var b=$(a.target).data("href");b.indexOf("javascript:")>=0||b&&(location.href=b)}}),q.on("partDone",function(a,b,c){"#article-tmpl"==b&&e.news.articleRendered()}),q.on("domDone",function(){function a(){var a=$(window).height(),b=$(window).scrollTop(),c=$(document).height(),d=Math.floor((a+b)/c*100);return d}function c(a,c){var d,f=[c],g=b(e,a),h=!0;g.prop&&g.prop.before&&(h=g.prop.before),h&&g.prop&&(d=g.prop.apply(this,f),d!==!1&&g.prop.after&&g.prop.after)}function d(a){var b=a.getBoundingClientRect(),c=$(window).height(),d=b.top,e=d+b.height,f=Math.min(b.height/2,c/3);return!(d>c-f||f>e)}function f(a){if("recommend-articles"==a){var b=[],c=$(".recommend-articles li");listlen=c.length;for(var e=0;e<listlen;e++)d(c[e])&&window.detListData&&b.push(window.detListData.related[e]);return b}if("hot-articles"==a){var f=[],c=$(".hot-articles li");listlen=c.length;for(var e=0;e<listlen;e++)d(c[e])&&window.detListData&&f.push(window.detListData.hotNewsList[e]);return f}if("recommend-video"==a){var g=[],c=$(".recommend-video li");listlen=c.length;for(var e=0;e<listlen;e++)d(c[e])&&window.detListData&&g.push(window.detListData.related_video[e]);return g}if("rss-articles"==a){var h=[],c=$(".rss-articles li");listlen=c.length;for(var e=0;e<listlen;e++)d(c[e])&&window.detListData&&h.push(window.detListData.media[e]);return h}}var g=0,h=0,i=$("body");i.on("touchstart",function(a){g=a.targetTouches[0].clientY}),i.on("touchend",function(a){endPosY=a.changedTouches[0].clientY,Math.abs(endPosY-g)>30&&h++});var j=null;$(window).scroll(function(){j&&clearTimeout(j),j=setTimeout(function(){var b={percent:a(),slidingCnt:h,showedRelatedList:f("recommend-articles"),showedHotList:f("hot-articles"),showedVideoList:f("recommend-video"),showedrssList:f("rss-articles")};c("related.OnHitLog",JSON.stringify(b))},100)})})}(this);